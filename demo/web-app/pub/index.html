<!DOCTYPE html> <html> <head> <meta charset="utf-8"/> <title>模块调度机制 - 前端实例</title> <link href="../r/core.css?f60113d5f42327bc6e98898019f61f4b" type="text/css" rel="stylesheet"/><style type="text/css">#module-box{min-height:500px;_height:500px;}</style> </head> <body> <div class="g-doc"> <div class="g-hd"> <h1 class="m-logo">网易-杭研院-前端技术组-实例库</h1> <h2 class="m-title">模块调度机制</h2> </div> <div class="g-bd" id="module-box"></div> <div class="g-bd"> <div class="m-foot"> 如有任何问题，请联系：蔡剑飞(<a href="mailto:caijf@corp.netease.com">caijf@corp.netease.com</a>) </div> </div> <div class="g-ft"> <div class="m-foot"> &nbsp;&copy;&nbsp;网易-杭研院-前端技术组 </div> </div> </div> <div id="template-box" style="display:none;">  <textarea name="jst" id="ui-jst-0"> ui content </textarea> <textarea name="js">(function(){var u=NEJ.P,bn=NEJ.O,bu=NEJ.F,q=u('nej.e'),B=u('nej.u'),bm=u('nej.ut'),z=u('nej.ui'),cl;if(!!z._$$Abstract)return;z._$$Abstract=NEJ.C();cl=z._$$Abstract._$extend(bm._$$Event);cl.__init=function(){this.__supInit();q._$dumpCSSText();this.__initXGui();this.__initNode();};cl.__reset=function(A){this.__supReset(A);this.__doInitClass(A.clazz);this._$appendTo(A.parent);};cl.__destroy=function(){this.__supDestroy();this.__doDelParentClass();delete this.__parent;q._$removeByEC(this.__body);q._$delClassName(this.__body,this.__class);delete this.__class;};cl.__initXGui=bu;cl.__initNode=function(){if(!this.__seed_html)this.__initNodeTemplate();this.__body=q._$getNodeTemplate(this.__seed_html);if(!this.__body)this.__body=q._$create('div',this.__seed_css);q._$addClassName(this.__body,this.__seed_css);};cl.__initNodeTemplate=bu;cl.__doInitClass=function(bl){this.__class=bl||'';q._$addClassName(this.__body,this.__class);};cl.__doAddParentClass=function(){if(!this.__seed_css)return;q._$addClassName(this.__parent,this.__seed_css+'-parent');};cl.__doDelParentClass=function(){if(!this.__seed_css)return;q._$delClassName(this.__parent,this.__seed_css+'-parent');};cl._$getBody=function(){return this.__body;};cl._$appendTo=function(bi){if(!this.__body)return this;this.__doDelParentClass();if(B._$isFunction(bi)){this.__parent=bi(this.__body);}else{this.__parent=q._$get(bi);if(!!this.__parent)this.__parent.appendChild(this.__body);}this.__doAddParentClass();return this;};cl._$show=function(){if(!this.__parent||!this.__body||this.__body.parentNode==this.__parent)return this;this.__parent.appendChild(this.__body);return this;};cl._$hide=function(){q._$removeByEC(this.__body);return this;};}());
(function(){window.dispatcher._$loaded('/',null);}());</textarea> <textarea name="jst" id="m-jst-0"> <div class="w-tab"> {list xlist as x} <a class="itm js-tag" href="#">${x.name}</a> {/list} </div> <div class="w-box"></div> </textarea> <textarea name="css">.w-tab{border-bottom:1px solid #000;overflow:hidden;text-align:center;font-size:16px;zoom:1;}.w-tab .itm{display:block;float:left;width:100px;height:30px;line-height:30px;margin-right:10px;color:#000;background:#aaa;}.w-tab .itm:hover{text-decoration:none;}.w-tab .js-selected{background:#000;color:#fff;}.w-box{padding:10px 0;}</textarea><textarea name="js">(function(){var u=NEJ.P,q=u('nej.e'),T=u('nej.v'),B=u('nej.u'),bm=u('dm.ut'),z=NEJ.P('dm.m'),bg=window,dO,he;z._$$ModuleM=NEJ.C();dO=z._$$ModuleM._$extend(bm._$$Module,!0);he=z._$$ModuleM._$supro;dO.__doBuild=function(){this.__xlist=[{url:'/m/a/',name:'A',umi:'/m/a/a0/'},{url:'/m/b/',name:'B'},{url:'/m/c/',name:'C'},{url:'/m/d/',name:'D'}];this.__body=q._$create('div');q._$renderHtmlTemplate(this.__body,'m-jst-0',{xlist:this.__xlist});var G=q._$getChildren(this.__body);this.__export.box=G[1];this.__tab=q._$tab(G[0],{clazz:'js-tag'});this.__tab._$setEvent('onchange',this.__onTabChange._$bind(this));};dO.__doSyncTab=function(U){var bj=B._$indexOf(this.__xlist,function(bG){return U.indexOf(bG.url)>=0;});if(bj<0)return;this.__tab._$go(bj);var bc=this.__xlist[0];if(U.indexOf(bc.url)>=0)bc.umi=U;};dO.__onTabChange=function(g){var bc=this.__xlist[g.index];bg.dispatcher._$redirect(bc.umi||bc.url);};dO.__onShow=function(g){this.__doSyncTab(g.href);he.__onShow.apply(this,arguments);};dO.__onRefresh=function(g){this.__doSyncTab(g.href);};bg.dispatcher._$loaded('/m',z._$$ModuleM);}());</textarea> <textarea name="jst" id="a-jst-0"> <div class="w-tab2"> {list xlist as x} <a class="itm js-tag" href="#">${x.name}</a> {/list} </div> <div class="w-box2"></div> </textarea> <textarea name="css">.m-a .w-tab2{float:left;width:100px;margin-right:-100px;text-align:center;font-size:14px;}.m-a .w-tab2 .itm{display:block;height:30px;line-height:30px;margin-bottom:5px;color:#000;background:#ccc;}.m-a .w-tab2 .itm:hover{text-decoration:none;}.m-a .w-tab2 .js-selected{background:#888;color:#fff;font-weight:bold;}.m-a .w-box2{margin-left:100px;padding-left:10px;border-left:1px solid #888;}</textarea><textarea name="js">(function(){var u=NEJ.P,q=u('nej.e'),T=u('nej.v'),B=u('nej.u'),bm=u('dm.ut'),z=NEJ.P('dm.m'),bg=window,dB,gR;z._$$ModuleA=NEJ.C();dB=z._$$ModuleA._$extend(bm._$$Module,!0);gR=z._$$ModuleA._$supro;dB.__doBuild=function(){this.__xlist=[{url:'/m/a/a0/',name:'A0'},{url:'/m/a/a1/',name:'A1'},{url:'/m/a/a2/',name:'A2'}];this.__body=q._$create('div','m-a');q._$renderHtmlTemplate(this.__body,'a-jst-0',{xlist:this.__xlist});var G=q._$getChildren(this.__body);this.__export.box=G[1];this.__tab=q._$tab(G[0],{clazz:'js-tag'});this.__tab._$setEvent('onchange',this.__onTabChange._$bind(this));};dB.__doSyncTab=function(U){var bj=B._$indexOf(this.__xlist,function(bG){return bG.url===U;});if(bj<0)return;this.__tab._$go(bj);};dB.__onTabChange=function(g){bg.dispatcher._$redirect(this.__xlist[g.index].url);};dB.__onShow=function(g){this.__doSyncTab(g.href);gR.__onShow.apply(this,arguments);};dB.__onRefresh=function(g){this.__doSyncTab(g.href);};bg.dispatcher._$loaded('/m/a',z._$$ModuleA);}());</textarea>  </div> <script type="text/javascript">location.config = {"ver":{"index/a.a0.html":"fb725b0f1ec9a54ae9331e3d5a7dacac","index/a.a1.html":"de54b66ba94c6aa4d99ed619d8a27e95","index/a.a2.html":"da2b3c845d193414b10ea373a1e83424","index/a.html":"e9c5d046c41d8a99a7cb517ecdf10e0f","index/b.b0.html":"f6858af9bbc7d581f01dc479445def47","index/b.b1.html":"65d72ece851ce5d1ddb3b2a281a934fb","index/b.b2.html":"5f319e8cd75a245d98c019831307bebd","index/b.html":"2edca6e81f018039c8f8cc77ee115be9","index/c.html":"2d1dbd0d1c454b9e989bcdcf228c481b","index/d.d0.html":"761eec5028a86f61bf233859d1afa020","index/d.d1.html":"2f8f71b58552b1d132970d5c128e368f","index/d.d2.html":"01c9170d87823573e9fe4fc0f34259bc","index/d.html":"44bc0f2fce7b5ad7b1ba19b59c62094f","index/m.html":"40989375ece95653fe3a1097ab929782","index/ui.html":"17520ff446afbb9529f24224ecf4e261","index.html":"ebc1f13163eb2a99de840b581629f4d7","simple.html":"f3c3792b2896ca277a36c93b1338073a","test/a.html":"7b52dd9dcc114f4d9f9a581a454368a9","test/b.html":"7b52dd9dcc114f4d9f9a581a454368a9"},"root":"./"};</script> <div style="display:none;" id="umi://index/a.a0.html"><meta charset="utf-8"/> <textarea name="ntp" id="a0-ntp-0"> <div class="m-a0"> <input type="button" value="send message to C"/> <p>0000000000000000000000</p> <p>0000000000000000000000</p> <p>0000000000000000000000</p> <p>0000000000000000000000</p> <p>0000000000000000000000</p> <p>0000000000000000000000</p> <p>0000000000000000000000</p> </div> </textarea> <textarea name="css">.m-a0{min-height:500px;_height:500px;background:#f00;}.m-a0 input{padding:5px 10px;margin:10px 0;}</textarea><textarea name="js">(function(){var u=NEJ.P,q=u('nej.e'),T=u('nej.v'),B=u('nej.u'),bm=u('dm.ut'),z=NEJ.P('dm.m'),bg=window,fF,iP;z._$$ModuleA0=NEJ.C();fF=z._$$ModuleA0._$extend(bm._$$Module,!0);iP=z._$$ModuleA0._$supro;fF.__doBuild=function(){this.__body=q._$getNodeTemplate('a0-ntp-0');T._$addEvent(this.__body.getElementsByTagName('input')[0],'click',this.__doSendMessage._$bind(this));};fF.__doSendMessage=function(){bg.dispatcher._$message({to:'/m/c/',from:this.__umi,data:'hello C! my name is a0.'});};bg.dispatcher._$loaded('/m/a/a0/',z._$$ModuleA0);}());</textarea></div><div style="display:none;" id="umi://index/a.a1.html"><meta charset="utf-8"/> <textarea name="ntp" id="a1-ntp-0"> <div class="m-a1"> <input type="button" value="send message to C"/> <input type="button" value="send message to A0"/> <p>1111111111111111111111111111</p> <p>1111111111111111111111111111</p> <p>1111111111111111111111111111</p> <p>1111111111111111111111111111</p> <p>1111111111111111111111111111</p> <p>1111111111111111111111111111</p> <p>1111111111111111111111111111</p> </div> </textarea> <textarea name="css">.m-a1{min-height:500px;_height:500px;background:#fdc;}.m-a1 input{padding:5px 10px;margin:10px 0;}</textarea><textarea name="js">(function(){var u=NEJ.P,q=u('nej.e'),T=u('nej.v'),B=u('nej.u'),bm=u('dm.ut'),z=NEJ.P('dm.m'),bg=window,fE,iR;z._$$ModuleA1=NEJ.C();fE=z._$$ModuleA1._$extend(bm._$$Module,!0);iR=z._$$ModuleA1._$supro;fE.__doBuild=function(){this.__body=q._$getNodeTemplate('a1-ntp-0');var G=this.__body.getElementsByTagName('input');T._$addEvent(G[0],'click',this.__doSendMessage._$bind(this,'/m/c/'));T._$addEvent(G[1],'click',this.__doSendMessage._$bind(this,'/m/a/a0/'));};fE.__doSendMessage=function(cp){bg.dispatcher._$message({to:cp,from:this.__umi,data:'hello C! my name is a1.'});};bg.dispatcher._$loaded('/m/a/a1/',z._$$ModuleA1);}());</textarea></div><div style="display:none;" id="umi://index/a.a2.html"><meta charset="utf-8"/> <textarea name="ntp" id="a2-ntp-0"> <div class="m-a2"> <input type="button" value="send message to C"/> <p>222222222222222222222222222</p> <p>222222222222222222222222222</p> <p>222222222222222222222222222</p> <p>222222222222222222222222222</p> <p>222222222222222222222222222</p> <p>222222222222222222222222222</p> <p>222222222222222222222222222</p> <p>222222222222222222222222222</p> <p>222222222222222222222222222</p> </div> </textarea> <textarea name="css">.m-a2{min-height:500px;_height:500px;background:#aaa;}.m-a2 input{padding:5px 10px;margin:10px 0;}</textarea><textarea name="js">(function(){var u=NEJ.P,q=u('nej.e'),T=u('nej.v'),B=u('nej.u'),bm=u('dm.ut'),z=NEJ.P('dm.m'),bg=window,fz,iT;z._$$ModuleA2=NEJ.C();fz=z._$$ModuleA2._$extend(bm._$$Module,!0);iT=z._$$ModuleA2._$supro;fz.__doBuild=function(){this.__body=q._$getNodeTemplate('a2-ntp-0');T._$addEvent(this.__body.getElementsByTagName('input')[0],'click',this.__doSendMessage._$bind(this));};fz.__doSendMessage=function(){bg.dispatcher._$message({to:'/m/c/',from:this.__umi,data:'hello C! my name is a2.'});};bg.dispatcher._$loaded('/m/a/a2/',z._$$ModuleA2);}());</textarea></div><script src="../r/core.js?6b2592408aab2bf13401bd76c52f2f43" type="text/javascript"></script><script type="text/javascript">(function(){var u=NEJ.P,bn=NEJ.O,B=u('nej.u'),bm=u('nej.ut'),z=u('nej.ut.p'),ck;if(!!z._$$Node)return;z._$$Node=NEJ.C();ck=z._$$Node._$extend(bm._$$Event);ck.__init=function(){this.__supInit();this.__children=[];};ck.__reset=function(A){this.__supReset(A);this._$setParent(A.parent);this.__name=A.name||'/';this.__data=A.data||{};};ck.__destroy=function(){var eg=function(S,bj,G){G.splice(bj,1);S._$recycle();};return function(){this.__supDestroy();delete this.__data;B._$reverseEach(this.__children,eg);this._$setParent(null);};}();ck.__isNode=function(S){return S instanceof z._$$Node;};ck.__hasChild=function(ci){return B._$indexOf(this.__children,ci)>=0;};ck._$getName=function(){return this.__name;};ck._$getData=function(){return this.__data;};ck._$getPath=function(){var bi=this._$getParent(),I=this._$getName();if(!bi)return I;var dz=bi._$getName();if(dz!='/'&&I!='/')I='/'+I;return bi._$getPath()+I;};ck._$getParent=function(){return this.__parent;};ck._$getChildren=function(){return this.__children;};ck._$getChildByName=function(I){var bj=B._$indexOf(this.__children,function(S){return I==S._$getName();});return this.__children[bj]||null;};ck._$setParent=function(bi){bi=this.__isNode(bi)?bi:null;if(bi==this.__parent)return;!!bi?bi._$appendChild(this):this.__parent._$removeChild(this);this.__parent=bi;return this;};ck._$appendChild=function(ci){ci=this.__isNode(ci)?ci:null;if(!ci||this.__hasChild(ci))return;this.__children.push(ci);ci._$setParent(this);return this;};ck._$removeChild=function(ci){ci=this.__isNode(ci)?ci:null;var bj=B._$indexOf(this.__children,ci);if(bj>=0){this.__children.splice(bj,1);ci._$setParent(null);}return ci;};}());
(function(){var u=NEJ.P,bu=NEJ.F,B=u('nej.u'),bm=u('nej.ut'),z=u('nej.ut.p');var hg=function(bK,U,fs){var S=bK,fs=fs||bu;if(U!='/'){B._$forEach(U.split('/'),function(I){var bh=fs(S,I);if(!bh)return!0;S=bh;});}return S;};z._$getNodeByUMI=function(){var eb=function(bi,I){var I=I||'/',dz=bi._$getName();if(dz=='/'&&I=='/')return bi;return bi._$getChildByName(I);};return function(bK,U){return hg(bK,U,eb);};}();z._$appendNodeByUMI=function(){var jx=function(bi,I){var dz=bi._$getName();if(!I&&dz=='/')return bi;var S=null;if(dz!='/'){S=bi._$getChildByName('/');if(!S){S=z._$$Node._$allocate();bi._$appendChild(S);}}if(!!I){S=bi._$getChildByName(I);if(!S){S=z._$$Node._$allocate({name:I});bi._$appendChild(S);}}return S;};return function(bK,U){return hg(bK,U,jx);};}();z._$getCommonRoot=function(bK,cg,bA){if(!cg||!bA)return bK;var cg=cg._$getPath().split('/'),bA=bA._$getPath().split('/'),jz=B._$forIn(cg,function(bf,bj){if(bf!=bA[bj])return!0;})||1,U=cg.splice(0,jz).join('/')||'/';return z._$getNodeByUMI(bK,U);};z._$breadthFirstSearch=function(bK,bx){var bk=[bK],S=bk.shift(),bx=bx||bu;while(!!S){bk.push.apply(bk,S._$getChildren());bx(S);S=bk.shift();}return this;};z._$isNode=function(S){return S instanceof z._$$Node;};z._$isModule=function(br){return br instanceof bm._$$Module;};z._$isUMIPrivate=function(){var bt=/^\/?\?(?=\/|$)/;return function(U){return bt.test(U||'');};}();z._$path2umi=function(){var bt=/[\?#]/;return function(ba){var bk=(ba||'').trim().split(bt),jB=bk[0]=='/'&&(bk[1]||'').indexOf('/')==0;return bk[0]+(jB?'?'+bk[1]:'');};}();}());
(function(){var u=NEJ.P,bn=NEJ.O,bg=u('nej.g'),q=u('nej.e'),bE=u('nej.j'),B=u('nej.u'),bm=u('nej.ut'),z=u('nej.ut.p'),cd;if(!!z._$$GroupManager)return;z._$$GroupManager=NEJ.C();cd=z._$$GroupManager._$extend(bm._$$Event);cd.__reset=function(A){this.__supReset(A);this.__root=A.root;this.__dispatcher=A.dispatcher;this.__mpool={};};cd.__destroy=function(){this.__supDestroy();delete this.__root;delete this.__mpool;};cd.__isStopped=function(S){if(!z._$isNode(S))return!1;return!!S._$getData().stopped||this.__isStopped(S._$getParent());};cd.__doClearStopped=function(S){if(!z._$isNode(S))return;delete S._$getData().stopped;this.__doClearStopped(S._$getParent());};cd.__doModuleHide=function(bB,cp){this.__doModuleCheck('onhide',bB,cp);};cd.__doModuleShow=function(bB,cp){this.__doModuleCheck('onshow',bB,cp);this.__doModuleAction(bB);};cd.__doModuleRefresh=function(S){this.__doModuleCheck('onrefresh',S);this.__doModuleAction(S);};cd.__doModuleCheck=function(N,bB,cp){if(bB==cp||!z._$isNode(bB))return;if(N=='onhide')this.__doModuleDispatch(bB,N);this.__doModuleCheck(N,bB._$getParent(),cp);if(N!='onhide')this.__doModuleDispatch(bB,N);};cd.__doModuleAction=function(S){if(!z._$isNode(S))return!0;var Y=S._$getData(),fj=Y.action,br=Y.module;if(!this.__doModuleAction(S._$getParent())||!!fj&&B._$isString(br))return!1;if(!!br&&!!br._$allocate&&(!!fj&&fj!='onhide')){if(this.__isStopped(S))return;var A={umi:S._$getPath(),composite:Y.composite,dispatcher:this.__dispatcher};br=br._$allocate(A);if(z._$isModule(br)){Y.module=br;this.__doModuleDispatch(S,'onshow');}else{delete Y.module;}}delete Y.action;return!0;};cd.__doModuleDispatch=function(){var jE=function(S){var br;S=S._$getParent();while(!!S){br=S._$getData().module;if(z._$isModule(br)){return br._$getExportData();}S=S._$getParent();}return null;};return function(S,I){if(!z._$isNode(S))return;var Y=S._$getData(),br=Y.module,fh=I!='onhide';if(z._$isModule(br)){if(fh&&this.__isStopped(S))return;var g=!this.__source?Y.event:this.__source._$getData().event;if(!!g){g.umi=S._$getPath();g.data=jE(S);}var hj=Y.xname||'onhide';if(I=='onshow'&&hj!='onhide')I='onrefresh';if(I=='onrefresh'&&hj=='onhide')I='onshow';Y.xname=I;br._$dispatchEvent(I,g||{});if(fh&&!!g&&!!g.pos&&g.umi==g.target){q._$scrollTo(g.pos);}if(fh&&!!g){Y.stopped=g.stopped;delete g.stopped;}}else if(!!br){Y.action=I;if(I=='onshow'&&B._$isString(br)){var j=q._$get('umi://'+br);if(!!j){q._$parseTemplate(j);}else{var bc=location.config||bn;bE._$loadHtml((bc.root||'')+br,{version:(bc.ver||bn)[br],onloaded:q._$parseTemplate});}}}};}();cd._$hasUMI=function(U){return!!this.__mpool[U];};cd._$addUMI=function(U){this.__mpool[U]=!0;return this;};cd._$delUMI=function(U){delete this.__mpool[U];return this;};cd._$loadedUMI=function(U){if(this._$hasUMI(U))this.__doModuleAction(z._$getNodeByUMI(this.__root,U));return this;};cd._$dispatchUMI=function(U){if(this._$hasUMI(U)){var S=z._$getNodeByUMI(this.__root,U);this.__doClearStopped(S);this.__doModuleShow(S);}return this;};cd._$hideUMI=function(U){if(this._$hasUMI(U)){this.__doModuleHide(z._$getNodeByUMI(this.__root,U));}return this;};}());
(function(){var u=NEJ.P,bn=NEJ.O,bu=NEJ.F,q=u('nej.e'),z=u('nej.ut.p'),cX;if(!!z._$$SingleGroupManager)return;z._$$SingleGroupManager=NEJ.C();cX=z._$$SingleGroupManager._$extend(z._$$GroupManager);cX.__reset=function(A){this.__supReset(A);this.__classed=!!A.classed;};cX.__destroy=function(){this.__supDestroy();delete this.__cmroot;delete this.__source;};cX._$exitable=function(g){if(!this.__source)return!0;var br=this.__source._$getData().module;if(z._$isModule(br))br._$dispatchEvent('onbeforehide',g);return!g.stopped;};cX._$refresh=function(){if(!this.__source)return;window.setTimeout(this._$dispatchUMI._$bind(this,this.__source._$getPath()),0);};cX._$dispatchUMI=function(U){if(!this._$hasUMI(U))return this;var bA=z._$getNodeByUMI(this.__root,U),Y=bA._$getData();if(!Y.module)return this;var cg=this.__source,g=Y.event,fQ=bn;this.__source=bA;this.__doClearStopped(bA);if(!!cg){fQ=cg._$getData().event;g.referer=fQ.href||'';}if(cg==bA){this.__doModuleRefresh(this.__source);return this;}this.__cmroot=z._$getCommonRoot(this.__root,cg,bA);if(cg!=null){if(cg!=this.__cmroot){if(this.__classed)q._$delClassName(document.body,fQ.clazz);this.__doModuleHide(cg,this.__cmroot);}this.__doModuleRefresh(this.__cmroot);}else{this.__doModuleShow(this.__cmroot);}if(bA!=this.__cmroot){if(this.__classed)q._$addClassName(document.body,g.clazz);this.__doModuleShow(bA,this.__cmroot);}return this;};cX._$loadedUMI=function(U){if(this._$hasUMI(U))this.__doModuleAction(this.__source);return this;};cX._$hideUMI=bu;}());
(function(){var u=NEJ.P,T=u('nej.v'),B=u('nej.u'),ei=u('nej.p'),D=u('nej.h'),bm=u('nej.ut'),cx=/^[#?]+/,dV=/#(.*?)$/,cO=window,fL=!history.pushState||ei._$IS.android||!history.auto;var eP=function(ba,fJ){cO.history[!fJ?'pushState':'replaceState'](null,document.title,ba);};var eQ=function(){return location.parse(cO.location.href);};eP=eP._$aop(function(g){if(!fL)return;var E=g.args;g.stopped=!0;ba=E[0].replace(cx,'');!E[1]?cO.location.hash=ba:cO.location.replace('#'+ba);});eQ=eQ._$aop(function(g){if(!fL)return;g.stopped=!0;var cY=dV.test(cO.location.href)?RegExp.$1:'';g.value=location.parse(cY.replace(cx,''));});location.redirect=function(ba,fJ){eP(ba,fJ);return this;};location.active=function(){var dg,ba,bJ,fq,hl;var fk=function(fv){if(!!fq){fq=!1;return;}var g={oldValue:bJ,newValue:eQ()};if(!!location.ignored){location.ignored=!1;}else{T._$dispatchEvent(location,'beforeurlchange',g);if(g.stopped){if(!!bJ){fq=!0;eP(bJ.href,!0);}return;};}ba=cO.location.href;bJ=g.newValue;T._$dispatchEvent(location,'urlchange',bJ);D.__pushHistory(bJ.href);};var hn=function(){if(ba!=cO.location.href)fk();dg=requestAnimationFrame(hn);};return function(cP){if(!!hl)return this;hl=!0;cO=cP||window;if(fL&&'onhashchange'in window&&ei._$NOT_PATCH.trident2){T._$addEvent(cO,'hashchange',fk);fk();}else if(!dg){dg=requestAnimationFrame(hn);}return this;};}();location.parse=function(){var cj=/^https?:\/\/.*?\//i,cx=/[?#]/;return function(ba){var bh={href:ba};ba=(ba||'').replace(cj,'/').split(cx);var cz=1;if(ba[0]=='/'&&(ba[1]||'').indexOf('/')==0)cz=2;bh.path=ba.splice(0,cz).join('?');bh.query=B._$query2object(ba.join('&'));return bh;};}();location.same=function(ba){return eQ().href==ba;};bm._$$CustomEvent._$allocate({element:location,event:['beforeurlchange','urlchange']});}());
(function(){var u=NEJ.P,bn=NEJ.O,bu=NEJ.F,q=u('nej.e'),T=u('nej.v'),B=u('nej.u'),z=u('nej.ut'),cs=u('nej.ut.p'),bH;if(!!z._$$Dispatcher)return;z._$$Dispatcher=NEJ.C();bH=z._$$Dispatcher._$extend(z._$$Event);bH.__init=function(){this.__supInit();var by=+new Date();this.__pbseed='pb-'+by;this.__pvseed='pv-'+by;};bH.__reset=function(A){this.__dtmp={};this.__rest=!!A.rest;this.__root=cs._$$Node._$allocate();this.__config={m:{},mg:{},r:[],rr:{},al:{}};this.__groups={};this.__doBuildGroup(this.__pbseed);this.__groups[this.__pvseed]=cs._$$GroupManager._$allocate({root:this.__root,dispatcher:this});this.__doInitDomEvent([[location,'urlchange',this.__onURLChange._$bind(this)]]);this.__supReset(A);this._$rule(A.rules);this._$regist(A.modules);};bH.__destroy=function(){var eg=function(cw,W,bb){delete bb[W];cw._$recycle();};return function(){delete this.__config;this.__root=this.__root._$recycle();B._$forIn(this.__groups,eg);this.__supDestroy();};}();bH.__setModuleConf=function(U,W,bf){var dj=this.__config.m[U];if(!dj){dj={};this.__config.m[U]=dj;}dj[W]=bf;};bH.__getModuleConf=function(U,W){var dj=this.__config.m[U];return!dj?'':dj[W];};bH.__doBuildGroup=function(bI){if(!bI)return;var cw=this.__groups[bI];if(!cw){cw=cs._$$SingleGroupManager._$allocate({root:this.__root,dispatcher:this,classed:bI==this.__pbseed});this.__groups[bI]=cw;}return cw;};bH.__doAddUMI2Group=function(U,bI){var cw=this.__doBuildGroup(bI);if(!cw){bI=cs._$isUMIPrivate(U)?this.__pvseed:this.__pbseed;cw=this.__groups[bI];}cw._$addUMI(U);this.__config.mg[U]=bI;};bH.__doRewriteUMI=function(){var bt=/\$\d/;return function(U,fv){var bh;B._$forIn(this.__config.r,function(bc){B._$forIn(bc,function(bf,W){if(!!bf.test&&(bf.test(U)||bf.test(fv))){bh=bt.test(W)?U.replace(bf,W):W;return!0;}if(bf===U||bf===fv){bh=W;return!0;}});return!!bh;});return bh||U;};}();bH.__onURLChange=function(){var dy=/(?:^\/+)|(?:\/+$)/gi,cj=/#(\$.*?)$/;var jY=function(U,S){var dw=S._$getPath(),U=U.replace(dw,'').replace(dy,'');return U.split('/');};var ht=function(U,bb){var bf,bk=U.split('/');while(bk.length>0){if(!bk[bk.length-1]){bk.pop();}else{bk[bk.length-1]='';}bf=bb[bk.join('/')];if(!!bf)return bf;}return'';};return function(bJ){if(bJ.path.indexOf('$')==0)return;var ka=this.__dtmp[bJ.path];delete this.__dtmp[bJ.path];this._$dispatchEvent('onbeforechange',bJ);var U=this.__doRewriteUMI(bJ.path,bJ.href),bI=this.__config.mg[U];if(!bI&&this.__rest)bI=ht(U,this.__config.mg);if(!bI&&!cs._$isUMIPrivate(U)){U=this.__config.rr['404'];bI=this.__config.mg[U];}if(!bI&&this.__rest)bI=ht(U,this.__config.mg);if(!bI)return;var S=cs._$getNodeByUMI(this.__root,U),hu=null;if(this.__rest)hu=jY(U,S);var cg=U;U=S._$getPath();S._$getData().event={target:U,source:cg,href:bJ.href,param:bJ.query,input:ka,prest:hu,clazz:this.__getModuleConf(U,'clazz'),pos:cj.test(bJ.href)?RegExp.$1:''};var fb=this.__getModuleConf(cg,'title');if(!!fb)document.title=fb;this.__groups[bI]._$dispatchUMI(U);};}();bH.__onClickDelegate=function(){var kd=function(S){return!!q._$dataset(S,'href');};return function(g){var j=T._$getElement(g,kd);if(!!j){T._$stopDefault(g);this._$redirect(q._$dataset(j,'href'));}};}();bH._$rule=function(){var ke=['404'];var kf=function(bc,W){this._$rule(W,bc);};var kg=function(fb,U){this.__setModuleConf(U,'title',fb);};var kh=function(U,ki){this.__config.al[ki]=U;};var hw=function(bc){if(!bc)return;this.__config.r.push(bc);B._$forEach(ke,function(W){if(!bc[W])return;this.__config.rr[W]=bc[W];delete bc[W];},this);};var fc={title:function(bc){B._$forIn(bc,kg,this);},rewrite:function(bc){if(!B._$isArray(bc)){hw.call(this,bc);}else{B._$forEach(bc,hw,this);}},alias:function(bc){B._$forIn(bc,kh,this);}};return function(W,bc){if(B._$isArray(W)){bc=W;W='rewrite';}else if(!B._$isString(W)){B._$forIn(W,kf,this);return this;}(fc[W]||bu).call(this,bc);return this;};}();bH._$regist=function(){var kl=function(bc,U){this._$regist(U,bc);};var gI=function(br){return!!br&&!!br._$extend;};return function(U,bc){if(!B._$isString(U)){B._$forIn(U,kl,this);return this;}var Y=cs._$appendNodeByUMI(this.__root,U)._$getData(),br=Y.module;if(cs._$isModule(br)||gI(br))return this;var bI=this.__config.mg[U],br;if(B._$isString(bc)||gI(bc)){br=bc;}else{bc=bc||bn;bI=bc.gid;br=bc.module;if(!!bc.title)this.__setModuleConf(U,'title',bc.title);if(!!bc.clazz)this.__setModuleConf(U,'clazz',bc.clazz);if(!!bc.composite)Y.composite=bc.composite;}this.__doAddUMI2Group(U,bI);Y.module=br;return this;};}();bH._$message=function(){var fP=function(S,bO){var br=S._$getData().module;if(cs._$isModule(br))br._$dispatchEvent('onmessage',bO);};var fc=[fP,function(bA,bO){var bB=bO.from;while(!!bA){if(bA._$getPath()!=bB)fP(bA,bO);bA=bA._$getParent();}},function(bA,bO){var bB=bO.from;cs._$breadthFirstSearch(bA,function(S){if(S._$getPath()!=bB)fP(S,bO);});}];return function(bO){var g=NEJ.X({},bO),bA=cs._$getNodeByUMI(this.__root,g.to);g.path=bA._$getPath();(fc[g.mode]||fc[0]).call(this,bA,g);};}();bH._$publish=function(N,bO){var bO=NEJ.X({},bO);bO.type=N||'';this._$dispatchEvent((bO.from||'')+':'+bO.type,bO);};bH._$subscribe=function(U,N,bR){U=this.__config.al[U]||U;this._$pushEvent((U||'')+':'+(N||''),bR);};bH._$unsubscribe=function(U,N,bR){U=this.__config.al[U]||U;this._$delEvent((U||'')+':'+(N||''),bR);};bH._$apply=function(ba){return this._$redirect(ba);};bH._$hide=function(U){var bI=this.__config.mg[U];if(bI==this.__pvseed){this.__groups[bI]._$hideUMI(U);}return this;};bH._$redirect=function(ba,A){A=A||bn;var U=cs._$path2umi(ba),bJ=location.parse(ba);this.__dtmp[bJ.path]=A.input;if(cs._$isUMIPrivate(U)){this.__onURLChange(bJ);}else{var cw=this.__groups[this.__pbseed],g={target:bJ,umi:U};if(!!cw._$exitable(g)){if(location.same(ba)&&!!A.force){this.__onURLChange(bJ);}else{location.ignored=!!A.ignored;location.redirect(ba,!!A.replace);}}}return this;};bH._$refresh=function(ba){if(!!ba){this._$redirect(ba,{replace:!0,force:!0});}else{this.__groups[this.__pbseed]._$refresh();}};bH._$delegate=function(){this.__doInitDomEvent([[document,'click',this.__onClickDelegate._$bind(this)]]);return this;};bH._$active=function(){location.active();return this;};bH._$loaded=function(U,br){U=this.__config.al[U]||U;if(!B._$isArray(U)){this._$regist(U,br);this.__groups[this.__config.mg[U]]._$loadedUMI(U);}else{B._$forEach(U,function(W){this._$loaded(W,br);},this);}return this;};q._$startup=function(A){window.dispatcher=z._$$Dispatcher._$getInstance(A);q._$parseTemplate((A||bn).tid||'template-box');T._$addEvent(document,'templateready',function(){dispatcher._$active();});return window.dispatcher;};}());
(function(){var u=NEJ.P,q=u('nej.e'),bm=u('nej.ut');window.dispatcher=bm._$$Dispatcher._$getInstance({rules:{rewrite:{'404':'/m/a/a0/','/m/a/a0/':'/'},title:{'/m/b/':'Module B','/m/c/':'Module C'}},modules:{'/':'index/ui.html','/m':'index/m.html','/m/a':'index/a.html','/m/b/':'index/b.html','/m/c/':'index/c.html','/m/d/':'index/d.html','/m/a/a0/':{module:'index/a.a0.html',title:'Module A-A0',clazz:'g-aa0'},'/m/a/a1/':{module:'index/a.a1.html',title:'Module A-A1',clazz:'g-aa1'},'/m/a/a2/':{module:'index/a.a2.html',title:'Module A-A2',clazz:'g-aa2'},'/?/b/b0/':'index/b.b0.html','/?/b/b1/':'index/b.b1.html','/?/b/b2/':'index/b.b2.html','/?/d/d0/':{module:'index/d.d0.html',title:'Module D-D0',gid:'d'},'/?/d/d1/':{module:'index/d.d1.html',title:'Module D-D1',gid:'d'},'/?/d/d2/':{module:'index/d.d2.html',title:'Module D-D2',gid:'d'}}});q._$parseTemplate('template-box');dispatcher._$active();}());</script> </body> </html>